name: Marketing Automation

on:
  release:
    types: [published]
  workflow_dispatch:
    inputs:
      version:
        description: 'Version to promote (e.g., 0.3.0)'
        required: true
      skip_blog_publish:
        description: 'Skip publishing blogs (generate only)'
        required: false
        default: false
        type: boolean
      skip_social:
        description: 'Skip social media posting'
        required: false
        default: false
        type: boolean

jobs:
  validate-secrets:
    name: Validate Secrets
    runs-on: ubuntu-latest
    outputs:
      has_devto: ${{ steps.check.outputs.has_devto }}
      has_medium: ${{ steps.check.outputs.has_medium }}
      has_twitter: ${{ steps.check.outputs.has_twitter }}
      has_linkedin: ${{ steps.check.outputs.has_linkedin }}
    steps:
      - name: Check required secrets
        id: check
        run: |
          echo "Checking for required secrets..."
          
          # Check Dev.to API key
          if [ -n "${{ secrets.DEVTO_API_KEY }}" ]; then
            echo "has_devto=true" >> $GITHUB_OUTPUT
            echo "âœ“ Dev.to API key found"
          else
            echo "has_devto=false" >> $GITHUB_OUTPUT
            echo "âš  Dev.to API key not found"
          fi
          
          # Check Medium API key
          if [ -n "${{ secrets.MEDIUM_API_KEY }}" ]; then
            echo "has_medium=true" >> $GITHUB_OUTPUT
            echo "âœ“ Medium API key found"
          else
            echo "has_medium=false" >> $GITHUB_OUTPUT
            echo "âš  Medium API key not found"
          fi
          
          # Check Twitter credentials
          if [ -n "${{ secrets.TWITTER_API_KEY }}" ] && [ -n "${{ secrets.TWITTER_API_SECRET }}" ] && \
             [ -n "${{ secrets.TWITTER_ACCESS_TOKEN }}" ] && [ -n "${{ secrets.TWITTER_ACCESS_TOKEN_SECRET }}" ]; then
            echo "has_twitter=true" >> $GITHUB_OUTPUT
            echo "âœ“ Twitter credentials found"
          else
            echo "has_twitter=false" >> $GITHUB_OUTPUT
            echo "âš  Twitter credentials incomplete"
          fi
          
          # Check LinkedIn credentials
          if [ -n "${{ secrets.LINKEDIN_ACCESS_TOKEN }}" ]; then
            echo "has_linkedin=true" >> $GITHUB_OUTPUT
            echo "âœ“ LinkedIn access token found"
          else
            echo "has_linkedin=false" >> $GITHUB_OUTPUT
            echo "âš  LinkedIn access token not found"
          fi

  generate-content:
    name: Generate Marketing Content
    runs-on: ubuntu-latest
    needs: validate-secrets
    outputs:
      version: ${{ steps.version.outputs.version }}
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'

      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install -e .
          pip install requests python-dotenv tweepy

      - name: Determine version
        id: version
        run: |
          if [[ "${{ github.event_name }}" == "workflow_dispatch" ]]; then
            VERSION="${{ github.event.inputs.version }}"
          else
            VERSION=$(echo "${{ github.ref_name }}" | sed 's/^v//')
          fi
          echo "version=$VERSION" >> $GITHUB_OUTPUT
          echo "Using version: $VERSION"

      - name: Generate blog posts
        id: generate_blogs
        run: |
          echo "Generating blog posts for version ${{ steps.version.outputs.version }}"
          python scripts/automation/blog_generator.py ${{ steps.version.outputs.version }}
          echo "status=success" >> $GITHUB_OUTPUT
        continue-on-error: false

      - name: Generate social media posts
        id: generate_social
        run: |
          echo "Generating social media posts"
          python -c "
          import sys
          sys.path.insert(0, 'scripts/automation')
          from blog_generator import BlogGenerator
          from social_media_generator import SocialMediaGenerator
          
          version = '${{ steps.version.outputs.version }}'
          generator = BlogGenerator(version=version)
          social_gen = SocialMediaGenerator(version, generator.release_notes)
          social_gen.save_posts()
          "
          echo "status=success" >> $GITHUB_OUTPUT
        continue-on-error: false

      - name: Upload generated content
        uses: actions/upload-artifact@v4
        with:
          name: marketing-content
          path: |
            docs/blog/*.md
            docs/social/*.txt
          retention-days: 30

  publish-devto:
    name: Publish to Dev.to
    runs-on: ubuntu-latest
    needs: [validate-secrets, generate-content]
    if: needs.validate-secrets.outputs.has_devto == 'true' && github.event.inputs.skip_blog_publish != 'true'
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Download generated content
        uses: actions/download-artifact@v4
        with:
          name: marketing-content

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'

      - name: Install dependencies
        run: pip install requests

      - name: Publish to Dev.to
        env:
          DEVTO_API_KEY: ${{ secrets.DEVTO_API_KEY }}
          VERSION: ${{ needs.generate-content.outputs.version }}
        run: |
          python - <<'EOF'
          import os
          import sys
          import requests
          import json
          
          version = os.environ['VERSION']
          api_key = os.environ['DEVTO_API_KEY']
          
          # Read the generated Dev.to post
          devto_file = f"docs/blog/devto_v{version}_release.md"
          
          try:
              with open(devto_file, 'r', encoding='utf-8') as f:
                  content = f.read()
              
              # Parse frontmatter
              lines = content.split('\n')
              if lines[0] == '---':
                  frontmatter_end = lines[1:].index('---') + 1
                  body = '\n'.join(lines[frontmatter_end + 1:])
              else:
                  body = content
              
              # Prepare API request
              headers = {
                  'api-key': api_key,
                  'Content-Type': 'application/json'
              }
              
              data = {
                  'article': {
                      'title': f'Neural DSL v{version} Release - What\'s New',
                      'published': True,
                      'body_markdown': body,
                      'tags': ['neuralnetworks', 'python', 'machinelearning', 'deeplearning'],
                      'series': 'Neural DSL Releases'
                  }
              }
              
              # Post to Dev.to
              response = requests.post(
                  'https://dev.to/api/articles',
                  headers=headers,
                  json=data
              )
              
              if response.status_code == 201:
                  article = response.json()
                  print(f"âœ“ Published to Dev.to: {article['url']}")
                  print(f"Article ID: {article['id']}")
                  
                  # Save article URL for later use
                  with open('devto_url.txt', 'w') as f:
                      f.write(article['url'])
              else:
                  print(f"âœ— Failed to publish to Dev.to: {response.status_code}")
                  print(f"Response: {response.text}")
                  sys.exit(1)
                  
          except FileNotFoundError:
              print(f"âœ— Dev.to blog file not found: {devto_file}")
              sys.exit(1)
          except Exception as e:
              print(f"âœ— Error publishing to Dev.to: {str(e)}")
              sys.exit(1)
          EOF
        continue-on-error: true

      - name: Upload Dev.to URL
        if: success()
        uses: actions/upload-artifact@v4
        with:
          name: devto-url
          path: devto_url.txt
          retention-days: 30

  publish-medium:
    name: Publish to Medium
    runs-on: ubuntu-latest
    needs: [validate-secrets, generate-content]
    if: needs.validate-secrets.outputs.has_medium == 'true' && github.event.inputs.skip_blog_publish != 'true'
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Download generated content
        uses: actions/download-artifact@v4
        with:
          name: marketing-content

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'

      - name: Install dependencies
        run: pip install requests

      - name: Publish to Medium
        env:
          MEDIUM_API_KEY: ${{ secrets.MEDIUM_API_KEY }}
          MEDIUM_USER_ID: ${{ secrets.MEDIUM_USER_ID }}
          VERSION: ${{ needs.generate-content.outputs.version }}
        run: |
          python - <<'EOF'
          import os
          import sys
          import requests
          import json
          
          version = os.environ['VERSION']
          api_key = os.environ['MEDIUM_API_KEY']
          user_id = os.environ.get('MEDIUM_USER_ID', '')
          
          # Read the generated Medium post
          medium_file = f"docs/blog/medium_v{version}_release.md"
          
          try:
              with open(medium_file, 'r', encoding='utf-8') as f:
                  content = f.read()
              
              headers = {
                  'Authorization': f'Bearer {api_key}',
                  'Content-Type': 'application/json',
                  'Accept': 'application/json'
              }
              
              # Get user ID if not provided
              if not user_id:
                  me_response = requests.get('https://api.medium.com/v1/me', headers=headers)
                  if me_response.status_code == 200:
                      user_id = me_response.json()['data']['id']
                  else:
                      print(f"âœ— Failed to get Medium user ID: {me_response.status_code}")
                      sys.exit(1)
              
              # Prepare API request - create as draft
              data = {
                  'title': f'Neural DSL v{version} Release: What\'s New',
                  'contentFormat': 'markdown',
                  'content': content,
                  'tags': ['neural-networks', 'python', 'machine-learning', 'deep-learning', 'ai'],
                  'publishStatus': 'draft'  # Publish as draft for review
              }
              
              # Post to Medium
              response = requests.post(
                  f'https://api.medium.com/v1/users/{user_id}/posts',
                  headers=headers,
                  json=data
              )
              
              if response.status_code == 201:
                  post = response.json()['data']
                  print(f"âœ“ Published draft to Medium: {post['url']}")
                  print(f"Post ID: {post['id']}")
                  
                  # Save post URL for later use
                  with open('medium_url.txt', 'w') as f:
                      f.write(post['url'])
              else:
                  print(f"âœ— Failed to publish to Medium: {response.status_code}")
                  print(f"Response: {response.text}")
                  sys.exit(1)
                  
          except FileNotFoundError:
              print(f"âœ— Medium blog file not found: {medium_file}")
              sys.exit(1)
          except Exception as e:
              print(f"âœ— Error publishing to Medium: {str(e)}")
              sys.exit(1)
          EOF
        continue-on-error: true

      - name: Upload Medium URL
        if: success()
        uses: actions/upload-artifact@v4
        with:
          name: medium-url
          path: medium_url.txt
          retention-days: 30

  post-twitter:
    name: Post to Twitter/X
    runs-on: ubuntu-latest
    needs: [validate-secrets, generate-content]
    if: needs.validate-secrets.outputs.has_twitter == 'true' && github.event.inputs.skip_social != 'true'
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Download generated content
        uses: actions/download-artifact@v4
        with:
          name: marketing-content

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'

      - name: Install dependencies
        run: pip install tweepy

      - name: Post to Twitter/X
        env:
          TWITTER_API_KEY: ${{ secrets.TWITTER_API_KEY }}
          TWITTER_API_SECRET: ${{ secrets.TWITTER_API_SECRET }}
          TWITTER_ACCESS_TOKEN: ${{ secrets.TWITTER_ACCESS_TOKEN }}
          TWITTER_ACCESS_TOKEN_SECRET: ${{ secrets.TWITTER_ACCESS_TOKEN_SECRET }}
          VERSION: ${{ needs.generate-content.outputs.version }}
        run: |
          python - <<'EOF'
          import os
          import sys
          import tweepy
          
          version = os.environ['VERSION']
          
          # Authenticate with Twitter API
          auth = tweepy.OAuthHandler(
              os.environ['TWITTER_API_KEY'],
              os.environ['TWITTER_API_SECRET']
          )
          auth.set_access_token(
              os.environ['TWITTER_ACCESS_TOKEN'],
              os.environ['TWITTER_ACCESS_TOKEN_SECRET']
          )
          
          # Create API object
          api = tweepy.API(auth)
          
          # Read the generated Twitter post
          twitter_file = f"docs/social/twitter_v{version}.txt"
          
          try:
              with open(twitter_file, 'r', encoding='utf-8') as f:
                  tweet_text = f.read().strip()
              
              # Ensure tweet is within character limit
              if len(tweet_text) > 280:
                  tweet_text = tweet_text[:277] + "..."
              
              # Post tweet
              status = api.update_status(tweet_text)
              print(f"âœ“ Posted to Twitter/X: https://twitter.com/user/status/{status.id}")
              
              # Save tweet URL
              with open('twitter_url.txt', 'w') as f:
                  f.write(f"https://twitter.com/user/status/{status.id}")
                  
          except FileNotFoundError:
              print(f"âœ— Twitter post file not found: {twitter_file}")
              sys.exit(1)
          except tweepy.TweepyException as e:
              print(f"âœ— Error posting to Twitter: {str(e)}")
              sys.exit(1)
          except Exception as e:
              print(f"âœ— Unexpected error: {str(e)}")
              sys.exit(1)
          EOF
        continue-on-error: true

      - name: Upload Twitter URL
        if: success()
        uses: actions/upload-artifact@v4
        with:
          name: twitter-url
          path: twitter_url.txt
          retention-days: 30

  post-linkedin:
    name: Post to LinkedIn
    runs-on: ubuntu-latest
    needs: [validate-secrets, generate-content]
    if: needs.validate-secrets.outputs.has_linkedin == 'true' && github.event.inputs.skip_social != 'true'
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Download generated content
        uses: actions/download-artifact@v4
        with:
          name: marketing-content

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'

      - name: Install dependencies
        run: pip install requests

      - name: Post to LinkedIn
        env:
          LINKEDIN_ACCESS_TOKEN: ${{ secrets.LINKEDIN_ACCESS_TOKEN }}
          LINKEDIN_PERSON_URN: ${{ secrets.LINKEDIN_PERSON_URN }}
          VERSION: ${{ needs.generate-content.outputs.version }}
        run: |
          python - <<'EOF'
          import os
          import sys
          import requests
          import json
          
          version = os.environ['VERSION']
          access_token = os.environ['LINKEDIN_ACCESS_TOKEN']
          person_urn = os.environ.get('LINKEDIN_PERSON_URN', '')
          
          # Read the generated LinkedIn post
          linkedin_file = f"docs/social/linkedin_v{version}.txt"
          
          try:
              with open(linkedin_file, 'r', encoding='utf-8') as f:
                  post_text = f.read().strip()
              
              headers = {
                  'Authorization': f'Bearer {access_token}',
                  'Content-Type': 'application/json',
                  'X-Restli-Protocol-Version': '2.0.0'
              }
              
              # Get person URN if not provided
              if not person_urn:
                  me_response = requests.get(
                      'https://api.linkedin.com/v2/me',
                      headers=headers
                  )
                  if me_response.status_code == 200:
                      person_id = me_response.json()['id']
                      person_urn = f'urn:li:person:{person_id}'
                  else:
                      print(f"âœ— Failed to get LinkedIn person URN: {me_response.status_code}")
                      sys.exit(1)
              
              # Prepare post data
              post_data = {
                  'author': person_urn,
                  'lifecycleState': 'PUBLISHED',
                  'specificContent': {
                      'com.linkedin.ugc.ShareContent': {
                          'shareCommentary': {
                              'text': post_text
                          },
                          'shareMediaCategory': 'NONE'
                      }
                  },
                  'visibility': {
                      'com.linkedin.ugc.MemberNetworkVisibility': 'PUBLIC'
                  }
              }
              
              # Post to LinkedIn
              response = requests.post(
                  'https://api.linkedin.com/v2/ugcPosts',
                  headers=headers,
                  json=post_data
              )
              
              if response.status_code == 201:
                  post_id = response.json()['id']
                  print(f"âœ“ Posted to LinkedIn")
                  print(f"Post ID: {post_id}")
                  
                  # Save post ID
                  with open('linkedin_id.txt', 'w') as f:
                      f.write(post_id)
              else:
                  print(f"âœ— Failed to post to LinkedIn: {response.status_code}")
                  print(f"Response: {response.text}")
                  sys.exit(1)
                  
          except FileNotFoundError:
              print(f"âœ— LinkedIn post file not found: {linkedin_file}")
              sys.exit(1)
          except Exception as e:
              print(f"âœ— Error posting to LinkedIn: {str(e)}")
              sys.exit(1)
          EOF
        continue-on-error: true

      - name: Upload LinkedIn ID
        if: success()
        uses: actions/upload-artifact@v4
        with:
          name: linkedin-id
          path: linkedin_id.txt
          retention-days: 30

  update-github-discussions:
    name: Update GitHub Discussions
    runs-on: ubuntu-latest
    needs: [generate-content, publish-devto, publish-medium, post-twitter, post-linkedin]
    if: always()
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Download generated content
        uses: actions/download-artifact@v4
        with:
          name: marketing-content

      - name: Download URLs (if available)
        uses: actions/download-artifact@v4
        with:
          name: devto-url
          path: urls/
        continue-on-error: true

      - name: Download Medium URL
        uses: actions/download-artifact@v4
        with:
          name: medium-url
          path: urls/
        continue-on-error: true

      - name: Download Twitter URL
        uses: actions/download-artifact@v4
        with:
          name: twitter-url
          path: urls/
        continue-on-error: true

      - name: Download LinkedIn ID
        uses: actions/download-artifact@v4
        with:
          name: linkedin-id
          path: urls/
        continue-on-error: true

      - name: Create GitHub Discussion
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          VERSION: ${{ needs.generate-content.outputs.version }}
        run: |
          VERSION="${{ needs.generate-content.outputs.version }}"
          
          # Read the GitHub release notes
          RELEASE_NOTES_FILE="docs/blog/github_v${VERSION}_release.md"
          
          if [ -f "$RELEASE_NOTES_FILE" ]; then
            BODY=$(cat "$RELEASE_NOTES_FILE")
            
            # Append links to published content
            BODY="${BODY}\n\n---\n\n## ðŸ”— Published Content\n\n"
            
            if [ -f "urls/devto_url.txt" ]; then
              DEVTO_URL=$(cat urls/devto_url.txt)
              BODY="${BODY}- ðŸ“ [Read on Dev.to](${DEVTO_URL})\n"
            fi
            
            if [ -f "urls/medium_url.txt" ]; then
              MEDIUM_URL=$(cat urls/medium_url.txt)
              BODY="${BODY}- ðŸ“ [Read on Medium](${MEDIUM_URL})\n"
            fi
            
            if [ -f "urls/twitter_url.txt" ]; then
              TWITTER_URL=$(cat urls/twitter_url.txt)
              BODY="${BODY}- ðŸ¦ [Twitter/X Post](${TWITTER_URL})\n"
            fi
            
            if [ -f "urls/linkedin_id.txt" ]; then
              BODY="${BODY}- ðŸ’¼ LinkedIn Post (check your feed)\n"
            fi
            
            # Create discussion using GraphQL API
            gh api graphql -f query='
              mutation($repositoryId: ID!, $categoryId: ID!, $title: String!, $body: String!) {
                createDiscussion(input: {
                  repositoryId: $repositoryId,
                  categoryId: $categoryId,
                  title: $title,
                  body: $body
                }) {
                  discussion {
                    url
                  }
                }
              }' \
              -f repositoryId="$(gh api graphql -f query='query { repository(owner: "'${{ github.repository_owner }}'", name: "'${{ github.event.repository.name }}'") { id } }' --jq '.data.repository.id')" \
              -f categoryId="$(gh api graphql -f query='query { repository(owner: "'${{ github.repository_owner }}'", name: "'${{ github.event.repository.name }}'") { discussionCategories(first: 10) { nodes { id name } } } }' --jq '.data.repository.discussionCategories.nodes[] | select(.name == "Announcements") | .id')" \
              -f title="ðŸš€ Neural DSL v${VERSION} Released!" \
              -f body="$BODY" || echo "âš  Failed to create discussion (category may not exist)"
          else
            echo "âš  Release notes file not found: $RELEASE_NOTES_FILE"
          fi
        continue-on-error: true

  commit-blog-files:
    name: Commit Generated Blog Files
    runs-on: ubuntu-latest
    needs: [generate-content, publish-devto, publish-medium]
    if: always()
    permissions:
      contents: write
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}

      - name: Download generated content
        uses: actions/download-artifact@v4
        with:
          name: marketing-content

      - name: Configure Git
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"

      - name: Commit and push blog files
        env:
          VERSION: ${{ needs.generate-content.outputs.version }}
        run: |
          # Add generated blog files
          git add docs/blog/*.md docs/social/*.txt || true
          
          # Check if there are changes to commit
          if git diff --staged --quiet; then
            echo "No changes to commit"
          else
            git commit -m "docs: add generated marketing content for v${VERSION}"
            git push
            echo "âœ“ Committed and pushed blog files"
          fi
        continue-on-error: true

  summary:
    name: Marketing Automation Summary
    runs-on: ubuntu-latest
    needs: [validate-secrets, generate-content, publish-devto, publish-medium, post-twitter, post-linkedin, update-github-discussions, commit-blog-files]
    if: always()
    steps:
      - name: Generate Summary
        run: |
          echo "# ðŸ“Š Marketing Automation Summary" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "**Version:** ${{ needs.generate-content.outputs.version }}" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "## Status" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          
          # Content Generation
          if [ "${{ needs.generate-content.result }}" == "success" ]; then
            echo "- âœ… Content Generation: Success" >> $GITHUB_STEP_SUMMARY
          else
            echo "- âŒ Content Generation: Failed" >> $GITHUB_STEP_SUMMARY
          fi
          
          # Dev.to Publishing
          if [ "${{ needs.validate-secrets.outputs.has_devto }}" == "true" ]; then
            if [ "${{ needs.publish-devto.result }}" == "success" ]; then
              echo "- âœ… Dev.to Publishing: Success" >> $GITHUB_STEP_SUMMARY
            elif [ "${{ needs.publish-devto.result }}" == "skipped" ]; then
              echo "- â­ï¸ Dev.to Publishing: Skipped" >> $GITHUB_STEP_SUMMARY
            else
              echo "- âŒ Dev.to Publishing: Failed" >> $GITHUB_STEP_SUMMARY
            fi
          else
            echo "- âš ï¸ Dev.to Publishing: No API key configured" >> $GITHUB_STEP_SUMMARY
          fi
          
          # Medium Publishing
          if [ "${{ needs.validate-secrets.outputs.has_medium }}" == "true" ]; then
            if [ "${{ needs.publish-medium.result }}" == "success" ]; then
              echo "- âœ… Medium Publishing: Success (Draft)" >> $GITHUB_STEP_SUMMARY
            elif [ "${{ needs.publish-medium.result }}" == "skipped" ]; then
              echo "- â­ï¸ Medium Publishing: Skipped" >> $GITHUB_STEP_SUMMARY
            else
              echo "- âŒ Medium Publishing: Failed" >> $GITHUB_STEP_SUMMARY
            fi
          else
            echo "- âš ï¸ Medium Publishing: No API key configured" >> $GITHUB_STEP_SUMMARY
          fi
          
          # Twitter Posting
          if [ "${{ needs.validate-secrets.outputs.has_twitter }}" == "true" ]; then
            if [ "${{ needs.post-twitter.result }}" == "success" ]; then
              echo "- âœ… Twitter/X Posting: Success" >> $GITHUB_STEP_SUMMARY
            elif [ "${{ needs.post-twitter.result }}" == "skipped" ]; then
              echo "- â­ï¸ Twitter/X Posting: Skipped" >> $GITHUB_STEP_SUMMARY
            else
              echo "- âŒ Twitter/X Posting: Failed" >> $GITHUB_STEP_SUMMARY
            fi
          else
            echo "- âš ï¸ Twitter/X Posting: No credentials configured" >> $GITHUB_STEP_SUMMARY
          fi
          
          # LinkedIn Posting
          if [ "${{ needs.validate-secrets.outputs.has_linkedin }}" == "true" ]; then
            if [ "${{ needs.post-linkedin.result }}" == "success" ]; then
              echo "- âœ… LinkedIn Posting: Success" >> $GITHUB_STEP_SUMMARY
            elif [ "${{ needs.post-linkedin.result }}" == "skipped" ]; then
              echo "- â­ï¸ LinkedIn Posting: Skipped" >> $GITHUB_STEP_SUMMARY
            else
              echo "- âŒ LinkedIn Posting: Failed" >> $GITHUB_STEP_SUMMARY
            fi
          else
            echo "- âš ï¸ LinkedIn Posting: No access token configured" >> $GITHUB_STEP_SUMMARY
          fi
          
          # GitHub Discussions
          if [ "${{ needs.update-github-discussions.result }}" == "success" ]; then
            echo "- âœ… GitHub Discussions: Updated" >> $GITHUB_STEP_SUMMARY
          else
            echo "- âŒ GitHub Discussions: Failed" >> $GITHUB_STEP_SUMMARY
          fi
          
          # Blog Files Commit
          if [ "${{ needs.commit-blog-files.result }}" == "success" ]; then
            echo "- âœ… Blog Files: Committed" >> $GITHUB_STEP_SUMMARY
          else
            echo "- âŒ Blog Files: Commit failed" >> $GITHUB_STEP_SUMMARY
          fi
          
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "## ðŸ“ Required Secrets" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "Configure the following secrets in your repository settings:" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### Dev.to" >> $GITHUB_STEP_SUMMARY
          echo "- \`DEVTO_API_KEY\`: Your Dev.to API key" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### Medium" >> $GITHUB_STEP_SUMMARY
          echo "- \`MEDIUM_API_KEY\`: Your Medium integration token" >> $GITHUB_STEP_SUMMARY
          echo "- \`MEDIUM_USER_ID\`: Your Medium user ID (optional, will be auto-detected)" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### Twitter/X" >> $GITHUB_STEP_SUMMARY
          echo "- \`TWITTER_API_KEY\`: Twitter API key" >> $GITHUB_STEP_SUMMARY
          echo "- \`TWITTER_API_SECRET\`: Twitter API secret" >> $GITHUB_STEP_SUMMARY
          echo "- \`TWITTER_ACCESS_TOKEN\`: Twitter access token" >> $GITHUB_STEP_SUMMARY
          echo "- \`TWITTER_ACCESS_TOKEN_SECRET\`: Twitter access token secret" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### LinkedIn" >> $GITHUB_STEP_SUMMARY
          echo "- \`LINKEDIN_ACCESS_TOKEN\`: LinkedIn access token" >> $GITHUB_STEP_SUMMARY
          echo "- \`LINKEDIN_PERSON_URN\`: LinkedIn person URN (optional, will be auto-detected)" >> $GITHUB_STEP_SUMMARY
